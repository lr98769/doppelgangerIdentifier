<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Identifies PPCC data doppelgangers between and within biomedical datasets 
              using Pairwise Pearson's Correlation Coefficient (PPCC) as a similar metric
              and meta data to define a suitable PPCC cut off point. Package also provides
              functions to verify the presence of doppelganger effect. ">
<title>Identifies Doppelgangers Between Datasets With PPCC And Meta data • doppelgangerIdentifier</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Identifies Doppelgangers Between Datasets With PPCC And Meta data">
<meta property="og:description" content="Identifies PPCC data doppelgangers between and within biomedical datasets 
              using Pairwise Pearson's Correlation Coefficient (PPCC) as a similar metric
              and meta data to define a suitable PPCC cut off point. Package also provides
              functions to verify the presence of doppelganger effect. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">doppelgangerIdentifier</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="doppelgangeridentifier">doppelgangerIdentifier<a class="anchor" aria-label="anchor" href="#doppelgangeridentifier"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of doppelgangerIdentifier is to find PPCC data doppelgangers that may have an inflationary effect on model accuracy.</p>
<p><em>PPCC</em>: Pairwise Pearson’s Correlation Coefficient, the Pearson’s Correlation Coefficient between samples from two different batches.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of doppelgangerIdentifier from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"lr98769/doppelgangerIdentifier"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<p>There are 4 main functions in this package:</p>
<div class="section level3">
<h3 id="1-getppccdoppelgangers">1. getPPCCDoppelgangers<a class="anchor" aria-label="anchor" href="#1-getppccdoppelgangers"></a>
</h3>
<p>Finds PPCC data doppelgangers in the data using batch, class and patient id meta data.</p>
<p>*Note: The effectiveness of getPPCCDoppelganger is affected by the efficacy of the sva::ComBat. Differences in the distribution of classes between batches affects the effectiveness of ComBat and as a result PPCC doppelganger identification.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lr98769.github.io/doppelgangerIdentifier/">doppelgangerIdentifier</a></span><span class="op">)</span>
<span class="va">ppccDoppelgangerResults</span> <span class="op">=</span> <span class="fu"><a href="reference/getPPCCDoppelgangers.html">getPPCCDoppelgangers</a></span><span class="op">(</span><span class="va">raw_data</span>, <span class="va">meta_data</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="2-visualiseppccdoppelgangers">2. visualisePPCCDoppelgangers<a class="anchor" aria-label="anchor" href="#2-visualiseppccdoppelgangers"></a>
</h3>
<p>Shows the distribution of PPCCs of different sample pairs.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lr98769.github.io/doppelgangerIdentifier/">doppelgangerIdentifier</a></span><span class="op">)</span>
<span class="fu"><a href="reference/visualisePPCCDoppelgangers.html">visualisePPCCDoppelgangers</a></span><span class="op">(</span><span class="va">ppccDoppelgangerResults</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="3-verifydoppelgangers">3. verifyDoppelgangers<a class="anchor" aria-label="anchor" href="#3-verifydoppelgangers"></a>
</h3>
<p>Tests inflationary effects of the PPCC data doppelganger.</p>
<ul>
<li>Note: Refer to the documentation for the format of the experiment plan file.</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lr98769.github.io/doppelgangerIdentifier/">doppelgangerIdentifier</a></span><span class="op">)</span>
<span class="va">veri_result</span> <span class="op">=</span> <span class="fu"><a href="reference/verifyDoppelgangers.html">verifyDoppelgangers</a></span><span class="op">(</span><span class="va">experimentPlanFilename</span>, <span class="va">raw_data</span>, <span class="va">meta_data</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="4-visualiseverificationresults">4. visualiseVerificationResults<a class="anchor" aria-label="anchor" href="#4-visualiseverificationresults"></a>
</h3>
<p>Visualise the accuracy of each Train-Valid Pair.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lr98769.github.io/doppelgangerIdentifier/">doppelgangerIdentifier</a></span><span class="op">)</span>
<span class="fu"><a href="reference/visualiseVerificationResults.html">visualiseVerificationResults</a></span><span class="op">(</span><span class="va">veri_result</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="data-sets">Data Sets<a class="anchor" aria-label="anchor" href="#data-sets"></a>
</h2>
<p>4 unprocessed data sets (no batch correction carried out) and their meta data are available and ready to use with the doppelgangerIdentifer R package.</p>
<table class="table">
<colgroup>
<col width="4%">
<col width="59%">
<col width="36%">
</colgroup>
<thead><tr class="header">
<th align="center">Name</th>
<th align="center">Description</th>
<th align="center">Citation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">rc</td>
<td align="center">Renal Cell Carcinoma Proteomics Data Set</td>
<td align="center">Guo et al.</td>
</tr>
<tr class="even">
<td align="center">dmd</td>
<td align="center">Duchenne Muscular Dystrophy (DMD) Microarry Data Set</td>
<td align="center">Haslett et al. &amp; Pescatori et al.</td>
</tr>
<tr class="odd">
<td align="center">leuk</td>
<td align="center">Leukemia Microarry Data Set</td>
<td align="center">Golub et al. &amp; Armstrong et al.</td>
</tr>
<tr class="even">
<td align="center">all</td>
<td align="center">Acute Lymphoblastic Leukaemia (ALL) Microarry Data Set</td>
<td align="center">Ross et al. &amp; Yeoh et al.</td>
</tr>
</tbody>
</table>
<p><em>Note: Cite the original source of each data set used</em></p>
</div>
<div class="section level2">
<h2 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h2>
<p>In this example, we will be showing how PPCC data doppelgangers can be identified and verified for functionality with the doppelgangerIdentifier r package.</p>
<div class="section level3">
<h3 id="0-importing-the-doppelgangeridentifier-package">0) Importing the doppelgangerIdentifier package<a class="anchor" aria-label="anchor" href="#0-importing-the-doppelgangeridentifier-package"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://lr98769.github.io/doppelgangerIdentifier/">"doppelgangerIdentifier"</a></span><span class="op">)</span></code></pre></div>
<blockquote>
<p><strong>Doppelganger effect</strong>: When training and validation data are similar by chance, resulting in an inflation of model accuracies on the validation dataset regardless of how we train the model.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="1-importing-renal-carcinoma-rc-dataset">1) Importing Renal Carcinoma (RC) Dataset<a class="anchor" aria-label="anchor" href="#1-importing-renal-carcinoma-rc-dataset"></a>
</h3>
<p>To illustrate the impacts of the Doppelganger effect, we will be using a Renal Carcinoma (RC) gene expression dataset.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Import RC gene expression dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rc</span><span class="op">)</span>
<span class="co">#Import metadata for RC gene expression dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rc_metadata</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="2-what-do-functional-doppelgangers-look-like">2) What Do Functional Doppelgangers Look Like?<a class="anchor" aria-label="anchor" href="#2-what-do-functional-doppelgangers-look-like"></a>
</h3>
<blockquote>
<p><strong>Functional Doppelgangers</strong>: Sample pairs between training and validation datasets that cause doppelganger effect.</p>
</blockquote>
<div class="section level4">
<h4 id="identifying-doppelgangers">Identifying doppelgangers<a class="anchor" aria-label="anchor" href="#identifying-doppelgangers"></a>
</h4>
<p>When functional doppelgangers are found in both training and validation sets, the doppelganger effect is observed. Hence, it is important to identify these doppelgangers and prevent the doppelganger effect from inflating machine learning performance.</p>
<p>We define possible doppelgangers as samples of the same class (Both samples from Tumor or both samples from Normal) but from different patients. Sample pairs of different class would be used as negative controls while sample pairs of the same class and same patient, indicative of leakage, would be used as positive controls.</p>
<div class="section level5">
<h5 id="identifying-data-doppelgangers">Identifying Data Doppelgangers<a class="anchor" aria-label="anchor" href="#identifying-data-doppelgangers"></a>
</h5>
<blockquote>
<p><strong>Data Doppelgangers</strong>: Sample pairs of the same class that are highly similar and hence have a high chance of being functional doppelgangers</p>
</blockquote>
<blockquote>
<p><strong>Pairwise Pearson’s Correlation Coefficient</strong>: Pearson’s Correlation Coefficeint between sample pairs</p>
</blockquote>
<p>Since it is computationally tedious to test different subsets of the data that cause the doppelganger effect, we instead identify data doppelgangers, sample pairs that are highly similar and have a high probability of being functional doppelgangers. In our implementation, we utilized Pairwise Pearson’s Correlation Coefficient (PPCC) as a metric of similarity and define data doppelgangers identified by this method as PPCC data doppelgangers.</p>
<p>In section “3) Effects of functional doppelgangers in machine learning”, we will demonstrate that the PPCC data doppelgangers identified by this method are functional doppelgangers.</p>
<p>To show how PPCC data doppelgangers are identified with the RC data set, we treat each batch as a separate data set and try to find PPCC data doppelgangers between the 2 batches.</p>
<p><strong>These are the steps we use to identify PPCC data doppelgangers:</strong> <img src="tutorial/images/doppelgangerIdentification.png"></p>
<p><em>PPCC: Pairwise Pearson’s Correlation Coefficient</em></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ppccDoppelgangerResults</span> <span class="op">=</span> <span class="fu"><a href="reference/getPPCCDoppelgangers.html">getPPCCDoppelgangers</a></span><span class="op">(</span><span class="va">rc</span>, <span class="va">rc_metadata</span><span class="op">)</span>
<span class="co">#&gt; [1] "1. Batch correcting the 2 data sets with sva:ComBat..."</span>
<span class="co">#&gt; Found2batches</span>
<span class="co">#&gt; Adjusting for0covariate(s) or covariate level(s)</span>
<span class="co">#&gt; Standardizing Data across genes</span>
<span class="co">#&gt; Fitting L/S model and finding priors</span>
<span class="co">#&gt; Finding parametric adjustments</span>
<span class="co">#&gt; Adjusting the Data</span>
<span class="co">#&gt; [1] "2. Calculating PPCC between samples of each batch..."</span>
<span class="co">#&gt;   |                                                                              |=                                                                     |   1%  |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%</span>
<span class="co">#&gt; [1] "3. Labelling Sample Pairs according to their Class and Patient Similarities..."</span>
<span class="co">#&gt; [1] "4. Calculating PPCC cut off to identify PPCC data doppelgangers..."</span>
<span class="co">#&gt; [1] "5. Identifying PPCC data doppelgangers..."</span></code></pre></div>
<p>The functions above carry out step 1-5 and output the results into a list containing the following elements:</p>
<ol style="list-style-type: decimal">
<li>Batch_corrected: Batch corrected data set</li>
</ol>
<!-- end list --><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">ppccDoppelgangerResults</span><span class="op">$</span><span class="va">Batch_corrected</span><span class="op">)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>PPCC_matrix: Matrix of PPCC between samples of different batch (NumberOfSamplesInBatch1*NumberofSamplesInBatch2)</li>
</ol>
<!-- end list --><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">ppccDoppelgangerResults</span><span class="op">$</span><span class="va">PPCC_matrix</span><span class="op">)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>PPCC_df: Data frame of PPCC between samples of different batch (NumberOfSamplePairs*5). The columns of the data frame are as follows:</li>
</ol>
<!-- end list --><ul>
<li>Sample1: Name of first sample of the pair (From first batch)</li>
<li>Sample2: Name of second sample of the pair (From second batch)</li>
<li>PPCC: Pearson’s correlation coefficient of this sample pair</li>
<li>ClassPatient: Label for the sample pair according to class and patient id similarity</li>
<li>DoppelgangerLabel: Labels the sample pair as a PPCC data doppelganger or not</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">ppccDoppelgangerResults</span><span class="op">$</span><span class="va">PPCC_df</span><span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>cut_off: Cut off PPCC for the identification of PPCC data doppelgangers as sample pairs between the same class and different patient with PPCC greater than cut off point</li>
</ol>
<!-- end list --><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"PPCC cut off:"</span>, <span class="va">ppccDoppelgangerResults</span><span class="op">$</span><span class="va">cut_off</span><span class="op">)</span>
<span class="co">#&gt; [1] "PPCC cut off: 0.922552571814869"</span></code></pre></div>
<p>To visualize the PPCC data doppelgangers, we pass the ppccDoppelgangerResults (output list of getPPCCDoppelgangers) to the visualisePPCCDoppelgangers function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/visualisePPCCDoppelgangers.html">visualisePPCCDoppelgangers</a></span><span class="op">(</span>ppccDoppelgangerResults <span class="op">=</span> <span class="va">ppccDoppelgangerResults</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="3-effects-of-functional-doppelgangers-in-machine-learning">3) Effects of functional doppelgangers in machine learning<a class="anchor" aria-label="anchor" href="#3-effects-of-functional-doppelgangers-in-machine-learning"></a>
</h3>
<p>When functional doppelgangers are in both training and validation datasets, an inflation in accuracy on the validation data set regardless of how we train the model would be observed.</p>
<p>We show that the PPCC data doppelgangers found above cause the doppelganger effect when included in both training and validation sets with the following steps:</p>
<p><img src="tutorial/images/functionalDoppelgangerTesting.png"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">verificationResults</span> <span class="op">=</span> <span class="fu"><a href="reference/verifyDoppelgangers.html">verifyDoppelgangers</a></span><span class="op">(</span>
  experimentPlanFilename <span class="op">=</span> <span class="st">"tutorial/experimentPlan.csv"</span>,
  raw_data <span class="op">=</span> <span class="va">rc</span>,
  meta_data <span class="op">=</span> <span class="va">rc_metadata</span><span class="op">)</span>
<span class="co">#&gt; [1] "1. Preprocessing data..."</span>
<span class="co">#&gt; Found2batches</span>
<span class="co">#&gt; Adjusting for0covariate(s) or covariate level(s)</span>
<span class="co">#&gt; Standardizing Data across genes</span>
<span class="co">#&gt; Fitting L/S model and finding priors</span>
<span class="co">#&gt; Finding parametric adjustments</span>
<span class="co">#&gt; Adjusting the Data</span>
<span class="co">#&gt; [1] "2. Generating Feature Sets..."</span>
<span class="co">#&gt; [1] "3. Loading Experiment Plan..."</span>
<span class="co">#&gt; [1] "4. Training KNN models..."</span>
<span class="co">#&gt;   |                                                                              |=                                                                     |   1%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |=========                                                             |  12%  |                                                                              |==========                                                            |  14%  |                                                                              |===========                                                           |  15%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |==============                                                        |  19%  |                                                                              |===============                                                       |  21%  |                                                                              |================                                                      |  22%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |============================================                          |  62%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |=================================================                     |  69%  |                                                                              |==================================================                    |  71%  |                                                                              |===================================================                   |  72%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></code></pre></div>
<p>The above functions carry out the experiment plan in experimentPlan.csv and return the results in a list. The following are the elements in the list:</p>
<ol style="list-style-type: decimal">
<li>combat_minmax: The gene expression data set after min-max normalization.</li>
</ol>
<!-- end list --><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">verificationResults</span><span class="op">$</span><span class="va">combat_minmax</span><span class="op">)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>feature_sets: The 10 randomly generated feature sets and 2 feature set containing features of lowest and highest variance.</li>
</ol>
<!-- end list --><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">verificationResults</span><span class="op">$</span><span class="va">feature_sets</span><span class="op">)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>accuracy_mat: The accuracies of each training_validation and feature set pair in matrix format</li>
</ol>
<!-- end list --><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">verificationResults</span><span class="op">$</span><span class="va">accuracy_mat</span><span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>accuracy_df: The accuracies of each training_validation and feature set pair in dataframe form</li>
</ol>
<!-- end list --><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">verificationResults</span><span class="op">$</span><span class="va">accuracy_df</span><span class="op">)</span></code></pre></div>
<p>In our current experiment plan, there are 6 training-validation data set pairs:</p>
<ol style="list-style-type: decimal">
<li>0 Doppel: 0 Doppelgangers in validation</li>
<li>2 Doppel: 2 Doppelgangers in validation</li>
<li>4 Doppel: 4 Doppelgangers in validation</li>
<li>6 Doppel: 6 Doppelgangers in validation</li>
<li>8 Doppel: 8 Doppelgangers in validation</li>
<li>Perfect Leakage: 8 Samples in training are duplicated into validation</li>
</ol>
<p>The negative control, Binomial, does not require any form of training since it is the accuracy generated by 12 (number of feature sets) binomial distributions with N = 8 (because there are eight samples in the validation set) and P = 0.5 (probability of guessing the correct label for each validation sample).</p>
<p>The increasing number of doppelgangers in validation is used to illustrate the dosage dependent behaviour of doppelgangers.</p>
<p>Here we load in the experiment plan from a comma separated file. The experiment plan specifies the names of samples in each training set and validation set. Care has been taken to prevent any leakage between training and validation sets of 0-8 Doppel.</p>
<p>To visualize the effect of the PPCC data doppelgangers on validation accuracy, we pass the functionalityResults (output list of doppelgangerFunctionalityVerification) to the displayFunctionalityResults function.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ori_train_valid_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Doppel_0"</span>,<span class="st">"Doppel_2"</span>, <span class="st">"Doppel_4"</span>, <span class="st">"Doppel_6"</span>, <span class="st">"Doppel_8"</span>, <span class="st">"Neg_Con"</span>, <span class="st">"Pos_Con"</span><span class="op">)</span>

<span class="va">new_train_valid_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0 Doppel"</span>, <span class="st">"2 Doppel"</span>, <span class="st">"4 Doppel"</span>, <span class="st">"6 Doppel"</span>, <span class="st">"8 Doppel"</span>, <span class="st">"Binomial"</span>, <span class="st">"Perfect Leakage"</span><span class="op">)</span>

<span class="fu"><a href="reference/visualiseVerificationResults.html">visualiseVerificationResults</a></span><span class="op">(</span> <span class="va">verificationResults</span>, 
                            <span class="va">ori_train_valid_names</span>, 
                            <span class="va">new_train_valid_names</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="100%"></p>
<p>We observe a dosage dependent relationship between the number of doppelgangers and the accuracy of models on the validation set since accuracy increases as the number of doppelgangers in validation set increases.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>use_gpl3_license()</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing doppelgangerIdentifier</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Li Rong Wang <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-3546-9354" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Li Rong Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
